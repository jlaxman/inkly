# Backend - Development Dockerfile (single-stage)
# Used by docker-compose.yml; production uses Dockerfile (multi-stage)
FROM node:24-alpine

WORKDIR /app
RUN apk add --no-cache openssl netcat-openbsd

COPY package*.json ./
COPY prisma ./prisma/
RUN npm install

RUN npm run prisma:generate || true
COPY . .
RUN mkdir -p uploads

EXPOSE 3001
# Command overridden by docker-compose (db push + start:dev)
CMD ["npm", "run", "start:dev"]
